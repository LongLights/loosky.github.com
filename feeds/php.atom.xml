<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom"><title>Loosky's Blog</title><link href="http://loosky.com/" rel="alternate"></link><link href="http://loosky.com/feeds/php.atom.xml" rel="self"></link><id>http://loosky.com/</id><updated>2013-10-01T00:00:00+08:00</updated><entry><title>长微博生成（html to image）原理</title><link href="http://loosky.com/technology/2013/10/01/changweibo.html" rel="alternate"></link><updated>2013-10-01T00:00:00+08:00</updated><author><name>Loosky</name></author><id>tag:loosky.com,2013-10-01:technology/2013/10/01/changweibo.html</id><summary type="html">&lt;p&gt;在平时工作中有一些需求，简单而言就是需要将一些内容生成图片。简单的内容通过PhotoShop处理还行，但是类似于带表格等的内容，每次都通过PhotoShop进行处理太浪费时间。网上有很多类似于长微博等的生成工具，生成简单的图片还行，但是要使用富文本生成图片，则多需要money，于是便自己研究了一下基于PHP的实现。&lt;/p&gt;
&lt;p&gt;首先展示一下&lt;strong&gt;演示效果&lt;/strong&gt;：&lt;a href="http://loosky.cn/"&gt;http://loosky.cn/&lt;/a&gt;&lt;/p&gt;
&lt;h3&gt;需求及原理&lt;/h3&gt;
&lt;p&gt;基于PHP，将html内容生成图片（PNG，JPEG等）&lt;/p&gt;
&lt;h3&gt;实现方法&lt;/h3&gt;
&lt;h4&gt;1. 直接通过图形函数生成&lt;/h4&gt;
&lt;p&gt;可以直接使用PHP中自带的&lt;a href="http://php.net/manual/zh/book.image.php"&gt;GD库&lt;/a&gt;或&lt;a href="http://php.net/manual/zh/book.imagick.php"&gt;imagick&lt;/a&gt;，将文字内容转换成为图片。这在处理纯文字内容的时候是很给力的，但是对于富文本内容来说却很吃力了，很难处理好。目前开源的有&lt;a href="https://code.google.com/p/yenohblog/downloads/detail?name=painty.zip&amp;amp;can=2&amp;amp;q="&gt;painty&lt;/a&gt;等，可以支持p、img等几个简单的html标签。&lt;/p&gt;
&lt;h4&gt;2. html-&amp;gt;pdf-&amp;gt;png&lt;/h4&gt;
&lt;p&gt;该方式即首先将html内容生成pdf文档，再将pdf文档转换成为图片。&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;html to pdf&lt;/strong&gt;：目前较为成熟的方案包括&lt;a href="http://loosky.net/archives/1963.html"&gt;tcpdf&lt;/a&gt;，&lt;a href="http://html2pdf.fr/en/default"&gt;HTML2PDF&lt;/a&gt;等，其实HTML2PDF也是使用的tcpdf的内核;&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;pdf to png&lt;/strong&gt;：可以通过&lt;a href="http://php.net/manual/zh/book.imagick.php"&gt;imagick php&lt;/a&gt;扩展。&lt;/p&gt;
&lt;p&gt;目前基于该种方式的开源代码有&lt;a href="http://buffernow.com/html-to-image-php-script/"&gt;html to image&lt;/a&gt;，其原理如下图所示。&lt;/p&gt;
&lt;p&gt;&lt;img alt="html to image示意图" src="http://loosky.net/Upload/2013/09/html-to-image-php-script.png" /&gt;&lt;/p&gt;
&lt;p&gt;核心代码为（摘自：&lt;a href="http://buffernow.com/html-to-image-php-script/"&gt;http://buffernow.com/html-to-image-php-script/&lt;/a&gt;）：&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;    &lt;span class="c1"&gt;//获取某个URL地址的内容&lt;/span&gt;
    &lt;span class="n"&gt;echo&lt;/span&gt; &lt;span class="nf"&gt;file_get_contents&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="err"&gt;&amp;#39;&lt;/span&gt;&lt;span class="n"&gt;http&lt;/span&gt;&lt;span class="o"&gt;://&lt;/span&gt;&lt;span class="n"&gt;loosky&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;net&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="err"&gt;&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;

    &lt;span class="c1"&gt;//将内容转换成pdf文档&lt;/span&gt;
    &lt;span class="err"&gt;$&lt;/span&gt;&lt;span class="n"&gt;html2pdf&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;new&lt;/span&gt; &lt;span class="n"&gt;HTML2PDF&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="sc"&gt;&amp;#39;P&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="err"&gt;&amp;#39;&lt;/span&gt;&lt;span class="n"&gt;A4&lt;/span&gt;&lt;span class="err"&gt;&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
    &lt;span class="err"&gt;$&lt;/span&gt;&lt;span class="n"&gt;html2pdf&lt;/span&gt;&lt;span class="o"&gt;-&amp;gt;&lt;/span&gt;&lt;span class="n"&gt;writeHTML&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="err"&gt;$&lt;/span&gt;&lt;span class="n"&gt;html_content&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
    &lt;span class="err"&gt;$&lt;/span&gt;&lt;span class="n"&gt;file&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="err"&gt;$&lt;/span&gt;&lt;span class="n"&gt;html2pdf&lt;/span&gt;&lt;span class="o"&gt;-&amp;gt;&lt;/span&gt;&lt;span class="n"&gt;Output&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="err"&gt;&amp;#39;&lt;/span&gt;&lt;span class="n"&gt;temp&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;pdf&lt;/span&gt;&lt;span class="sc"&gt;&amp;#39;,&amp;#39;&lt;/span&gt;&lt;span class="n"&gt;F&lt;/span&gt;&lt;span class="err"&gt;&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;

    &lt;span class="c1"&gt;//将pdf文档转换成图片&lt;/span&gt;
    &lt;span class="err"&gt;$&lt;/span&gt;&lt;span class="n"&gt;im&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;new&lt;/span&gt; &lt;span class="n"&gt;imagick&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="err"&gt;&amp;#39;&lt;/span&gt;&lt;span class="n"&gt;temp&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;pdf&lt;/span&gt;&lt;span class="err"&gt;&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
    &lt;span class="err"&gt;$&lt;/span&gt;&lt;span class="n"&gt;im&lt;/span&gt;&lt;span class="o"&gt;-&amp;gt;&lt;/span&gt;&lt;span class="n"&gt;setImageFormat&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt; &lt;span class="s"&gt;&amp;quot;jpg&amp;quot;&lt;/span&gt; &lt;span class="p"&gt;);&lt;/span&gt;
    &lt;span class="err"&gt;$&lt;/span&gt;&lt;span class="n"&gt;img_name&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;time&lt;/span&gt;&lt;span class="p"&gt;().&lt;/span&gt;&lt;span class="err"&gt;&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;jpg&lt;/span&gt;&lt;span class="err"&gt;&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
    &lt;span class="err"&gt;$&lt;/span&gt;&lt;span class="n"&gt;im&lt;/span&gt;&lt;span class="o"&gt;-&amp;gt;&lt;/span&gt;&lt;span class="n"&gt;setSize&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;800&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mi"&gt;600&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
    &lt;span class="err"&gt;$&lt;/span&gt;&lt;span class="n"&gt;im&lt;/span&gt;&lt;span class="o"&gt;-&amp;gt;&lt;/span&gt;&lt;span class="n"&gt;writeImage&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="err"&gt;$&lt;/span&gt;&lt;span class="n"&gt;img_name&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
    &lt;span class="err"&gt;$&lt;/span&gt;&lt;span class="n"&gt;im&lt;/span&gt;&lt;span class="o"&gt;-&amp;gt;&lt;/span&gt;&lt;span class="n"&gt;clear&lt;/span&gt;&lt;span class="p"&gt;();&lt;/span&gt;
    &lt;span class="err"&gt;$&lt;/span&gt;&lt;span class="n"&gt;im&lt;/span&gt;&lt;span class="o"&gt;-&amp;gt;&lt;/span&gt;&lt;span class="n"&gt;destroy&lt;/span&gt;&lt;span class="p"&gt;();&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;这里使用了HTML2PDF的代码，其实个人建议使用tcpdf的，毕竟tcpdf的版本更新，功能更为强大。经过实际测试，tcpdf对中文、html格式等的支持更好，相对而言，HTML2PDF有点惨不忍睹，较长的中文会出现无法自动换行等基本错误。&lt;/p&gt;
&lt;p&gt;但同时，这种方法存在一个较大的缺陷，当插入了图片等媒体后，经常会出现一页内无法放进去需要重新在另外一页进行排版的问题，从而生成的图片就会有较大的空白区域；同时每页的内容如果没有完全排满的话，生成的图片同样存在较大的空白区域，十分不美观。&lt;/p&gt;
&lt;p&gt;因此，并不推荐这种方式。&lt;/p&gt;
&lt;h4&gt;3. 通过截图&lt;/h4&gt;
&lt;p&gt;该种方式类似于采用浏览器的截图功能，直接将某个URL地址的内容进行截图。相对前面两种方式而言：第一，对于富文本的html内容渲染更为方便、简单，直接生成html代码即可；第二，内容排版更为合理，不会出现pdf文档中存在的空白区域等问题；第三，对于中文的支持更为友好。&lt;/p&gt;
&lt;p&gt;目前主要的开源项目包括：&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;&lt;a href="http://khtml2png.sourceforge.net/"&gt;khtml2png&lt;/a&gt;&lt;/strong&gt;：基于Linux平台，可以将html转成图片格式，有如下要求：&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span class="n"&gt;g&lt;/span&gt;&lt;span class="o"&gt;++&lt;/span&gt;
&lt;span class="n"&gt;KDE&lt;/span&gt; &lt;span class="mf"&gt;3.&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;
&lt;span class="n"&gt;kdelibs&lt;/span&gt; &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;KDE&lt;/span&gt; &lt;span class="mf"&gt;3.&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;kdelibs4&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;dev&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="n"&gt;zlib&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;zlib1g&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;dev&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="n"&gt;cmake&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;对于服务器而言，尤其是资源比较吃紧的VPS而言，安装一个KED有点花销太大。&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;&lt;a href="http://cutycapt.sourceforge.net/"&gt;CutyCapt&lt;/a&gt;&lt;/strong&gt;及其兄弟版本&lt;strong&gt;&lt;a href="http://iecapt.sourceforge.net/"&gt;IECapt&lt;/a&gt;&lt;/strong&gt;：其中CutyCapt是基于Linux、Windows平台，IECapt基于Windows平台，支持svg,ps,pdf,itext,html,rtree,png,jpeg,mng,tiff,gif,bmp,ppm,xbm,xpm等多种格式，使用均较为简单，直接使用如下命令。&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;注意：CutyCapt的可执行命令在Windows平台和Linux平台下的大小写不太一致。&lt;/strong&gt;&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;CutyCapt&lt;/span&gt; &lt;span class="o"&gt;--&lt;/span&gt;&lt;span class="n"&gt;url&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;http&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="c1"&gt;//www.example.org --out=example.png&lt;/span&gt;

&lt;span class="n"&gt;IECapt&lt;/span&gt; &lt;span class="o"&gt;--&lt;/span&gt;&lt;span class="n"&gt;url&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;http&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="c1"&gt;//www.example.org/ --out=localfile.png&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;它的部署要求是：&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span class="n"&gt;CutyCapt&lt;/span&gt; &lt;span class="n"&gt;depends&lt;/span&gt; &lt;span class="n"&gt;on&lt;/span&gt; &lt;span class="n"&gt;Qt&lt;/span&gt; &lt;span class="mf"&gt;4.4.0&lt;/span&gt;&lt;span class="o"&gt;+&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;但是它比khtml2png好的一点是它可以不用装X server，可以用Xvfb这种轻量级的东西，然后可以这样使用：&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span class="n"&gt;xvfb&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;run&lt;/span&gt; &lt;span class="o"&gt;--&lt;/span&gt;&lt;span class="n"&gt;server&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;args&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;-screen 0, 1024x768x24&amp;quot;&lt;/span&gt; &lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;CutyCapt&lt;/span&gt; &lt;span class="o"&gt;--&lt;/span&gt;&lt;span class="n"&gt;url&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="p"&gt;...&lt;/span&gt; &lt;span class="o"&gt;--&lt;/span&gt;&lt;span class="n"&gt;out&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="p"&gt;...&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;通过对各种实现方式进行实际的对比，本人倾向于采用CutyCapt的方式。&lt;/p&gt;
&lt;h3&gt;具体实现过程&lt;/h3&gt;
&lt;p&gt;1、如&lt;a href="http://loosky.cn/"&gt;http://loosky.cn/&lt;/a&gt;首页所示，通过嵌入富文本编辑器，提供富文本编辑功能，同时可以提供对作者信息、版权标记、图片大小格式等的定制。&lt;/p&gt;
&lt;p&gt;2、将提交的内容进行过滤，并生成htm/html文档，通过CSS对生成的文档内容进行格式渲染。&lt;/p&gt;
&lt;p&gt;3、通过PHP执行CutyCapt命令，对生成的网页文件进行截图。&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;到这一步已经完全可以实现html内容生成图片的功能了，但CutyCapt生成的图片相对而言会比较大，因此还可以进一步进行优化。&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;4、通过imagick对生成的图片进行优化&lt;/p&gt;
&lt;p&gt;imagick具有强大的图片处理功能，可以优化CutyCapt生成的图片的质量及大小，同时还可以方便地进行加水印等操作。&lt;/p&gt;
&lt;h3&gt;开发经验分享&lt;/h3&gt;
&lt;p&gt;在实际开发过程中碰到了各种问题，进行一些分享。&lt;/p&gt;
&lt;h4&gt;1、操作系统选择&lt;/h4&gt;
&lt;p&gt;CutyCapt及imagick都有Linux和Windows的版本，在Windows下面的开发、运行不存在较大的问题，按照正常步骤进行安装配置即可。&lt;/p&gt;
&lt;p&gt;在Linux平台下，CutyCapt的安装教程可参考&lt;a href="http://www.cszhi.com/20130305/cutycapt.html"&gt;http://www.cszhi.com/20130305/cutycapt.html&lt;/a&gt;：&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;centos下安装cutycapt：&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;（1）安装qt47&lt;/p&gt;
&lt;p&gt;增加qt47的源&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span class="n"&gt;vim&lt;/span&gt; &lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;etc&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;yum&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;repos&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;d&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;atrpms&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;repo&lt;/span&gt;

&lt;span class="c1"&gt;//加入如下内容&lt;/span&gt;
&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;atrpms&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;
&lt;span class="n"&gt;name&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;CentOS&lt;/span&gt; &lt;span class="err"&gt;$&lt;/span&gt;&lt;span class="n"&gt;releasever&lt;/span&gt; &lt;span class="err"&gt;–&lt;/span&gt; &lt;span class="err"&gt;$&lt;/span&gt;&lt;span class="n"&gt;basearch&lt;/span&gt; &lt;span class="err"&gt;–&lt;/span&gt; &lt;span class="n"&gt;ATrpms&lt;/span&gt;
&lt;span class="n"&gt;baseurl&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;http&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="c1"&gt;//dl.atrpms.net/el$releasever-$basearch/atrpms/stable&lt;/span&gt;
&lt;span class="n"&gt;gpgkey&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;http&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="c1"&gt;//ATrpms.net/RPM-GPG-KEY.atrpms&lt;/span&gt;
&lt;span class="n"&gt;gpgcheck&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;
&lt;span class="n"&gt;enabled&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;

&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;atrpms&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;testing&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;
&lt;span class="n"&gt;name&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;CentOS&lt;/span&gt; &lt;span class="err"&gt;$&lt;/span&gt;&lt;span class="n"&gt;releasever&lt;/span&gt; &lt;span class="err"&gt;–&lt;/span&gt; &lt;span class="err"&gt;$&lt;/span&gt;&lt;span class="n"&gt;basearch&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt; &lt;span class="n"&gt;ATrpms&lt;/span&gt; &lt;span class="n"&gt;testing&lt;/span&gt;
&lt;span class="n"&gt;baseurl&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;http&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="c1"&gt;//dl.atrpms.net/el$releasever-$basearch/atrpms/testing&lt;/span&gt;
&lt;span class="n"&gt;gpgkey&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;http&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="c1"&gt;//ATrpms.net/RPM-GPG-KEY.atrpms&lt;/span&gt;
&lt;span class="n"&gt;gpgcheck&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;
&lt;span class="n"&gt;enabled&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;

&lt;span class="c1"&gt;//进行安装&lt;/span&gt;
&lt;span class="n"&gt;yum&lt;/span&gt; &lt;span class="n"&gt;update&lt;/span&gt;
&lt;span class="n"&gt;yum&lt;/span&gt; &lt;span class="n"&gt;install&lt;/span&gt; &lt;span class="n"&gt;qt47&lt;/span&gt;
&lt;span class="n"&gt;yum&lt;/span&gt; &lt;span class="n"&gt;install&lt;/span&gt; &lt;span class="n"&gt;qt47&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;devel&lt;/span&gt;
&lt;span class="n"&gt;yum&lt;/span&gt; &lt;span class="n"&gt;install&lt;/span&gt; &lt;span class="n"&gt;qt47&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;webkit&lt;/span&gt;
&lt;span class="n"&gt;yum&lt;/span&gt; &lt;span class="n"&gt;install&lt;/span&gt; &lt;span class="n"&gt;qt47&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;webkit&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;devel&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;2、安装cutycapt&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span class="n"&gt;yum&lt;/span&gt; &lt;span class="n"&gt;install&lt;/span&gt; &lt;span class="n"&gt;svn&lt;/span&gt;
&lt;span class="n"&gt;svn&lt;/span&gt; &lt;span class="n"&gt;co&lt;/span&gt; &lt;span class="n"&gt;https&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="c1"&gt;//cutycapt.svn.sourceforge.net/svnroot/cutycapt&lt;/span&gt;
&lt;span class="n"&gt;mv&lt;/span&gt; &lt;span class="n"&gt;cutycapt&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;CutyCapt&lt;/span&gt; &lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;usr&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;local&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;cutycapt&lt;/span&gt;
&lt;span class="n"&gt;cd&lt;/span&gt; &lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;usr&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;local&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;cutycapt&lt;/span&gt;
&lt;span class="n"&gt;qmake&lt;/span&gt;
&lt;span class="n"&gt;qmake&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;qt47&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;3、安装xvfb&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span class="n"&gt;yum&lt;/span&gt; &lt;span class="n"&gt;install&lt;/span&gt; &lt;span class="n"&gt;Xvfb&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;4、测试cutycapt截图&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span class="n"&gt;xvfb&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;run&lt;/span&gt; &lt;span class="o"&gt;--&lt;/span&gt;&lt;span class="n"&gt;server&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;args&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;-screen 0, 1024x768x24&amp;quot;&lt;/span&gt; &lt;span class="n"&gt;CutyCapt&lt;/span&gt; &lt;span class="o"&gt;--&lt;/span&gt;&lt;span class="n"&gt;url&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;http&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="c1"&gt;//www.baidu.com --out=baidu.png&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;5、将xvfb置入后台运行&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span class="n"&gt;Xvfb&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;fp&lt;/span&gt; &lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;usr&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;share&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;fonts&lt;/span&gt; &lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;screen&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt; &lt;span class="mi"&gt;1024&lt;/span&gt;&lt;span class="n"&gt;x768x24&lt;/span&gt; &lt;span class="o"&gt;&amp;amp;&lt;/span&gt;
&lt;span class="n"&gt;DISPLAY&lt;/span&gt;&lt;span class="o"&gt;=:&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt; &lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;CutyCapt&lt;/span&gt; &lt;span class="o"&gt;--&lt;/span&gt;&lt;span class="n"&gt;url&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;http&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="c1"&gt;//www.baidu.com --out=baidu.png&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;&lt;strong&gt;ubuntu下安装cutycapt&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;1、两条命令搞定&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span class="n"&gt;apt&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;get&lt;/span&gt; &lt;span class="n"&gt;install&lt;/span&gt; &lt;span class="n"&gt;cutycapt&lt;/span&gt;
&lt;span class="n"&gt;apt&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;get&lt;/span&gt; &lt;span class="n"&gt;install&lt;/span&gt; &lt;span class="n"&gt;xvfb&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;2、测试截图&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span class="n"&gt;xvfb&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;run&lt;/span&gt; &lt;span class="o"&gt;--&lt;/span&gt;&lt;span class="n"&gt;server&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;args&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;-screen 0, 1024x768x24&amp;quot;&lt;/span&gt; &lt;span class="n"&gt;CutyCapt&lt;/span&gt; &lt;span class="o"&gt;--&lt;/span&gt;&lt;span class="n"&gt;url&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;http&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="c1"&gt;//www.baidu.com --out=baidu.png&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;中文乱码问题：&lt;/p&gt;
&lt;p&gt;将windows下的中文字体上传至/usr/share/fonts目录，执行下命令fc-cache即可。&lt;/p&gt;
&lt;p&gt;在这里，作者想说的是，尽量选择Ubuntu吧，安装方便；更重要的是，CentOS下面会出现各种问题，如&lt;strong&gt;CutyCapt: cannot connect to X server :99&lt;/strong&gt;等，会让你非常郁闷，我甚至安装了新的包含Gnome、KDE桌面环境的操作系统仍无法解决，而在Ubuntu下面几乎不存在任何问题。&lt;/p&gt;
&lt;h4&gt;2、Web服务器的选择&lt;/h4&gt;
&lt;p&gt;因为截图功能涉及到PHP需要执行操作系统的CutyCapt命令，可以通过system()或者exec()函数。&lt;/p&gt;
&lt;p&gt;作者分别使用了apache和Nginx两种Web服务器，在Nginx下会出现执行调用CutyCapt的PHP脚本无法运行的情况，会遇到比较麻烦的权限问题，&lt;a href="http://alfred-long.iteye.com/blog/1578904"&gt;http://alfred-long.iteye.com/blog/1578904&lt;/a&gt;中提供了一种解决方案，但作者没有测试成功。使用apache服务器则是一路畅通，不存在这个问题。&lt;/p&gt;
&lt;p&gt;因此，作者建议选择&lt;strong&gt;Ubuntu+apache&lt;/strong&gt;的组合，千万不要选择&lt;strong&gt;CentOS+Nginx&lt;/strong&gt;，需要解决的麻烦问题太多，从而也容易造成一些不安全的因素。&lt;/p&gt;
&lt;p&gt;安装代码如下：&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span class="n"&gt;apt&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;get&lt;/span&gt; &lt;span class="n"&gt;install&lt;/span&gt; &lt;span class="n"&gt;apache2&lt;/span&gt;
&lt;span class="n"&gt;apt&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;get&lt;/span&gt; &lt;span class="n"&gt;install&lt;/span&gt; &lt;span class="n"&gt;php5&lt;/span&gt; &lt;span class="n"&gt;libapache2&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;mod&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;php5&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;h4&gt;3、Ubuntu中安装imagick&lt;/h4&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span class="n"&gt;apt&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;get&lt;/span&gt; &lt;span class="n"&gt;install&lt;/span&gt; &lt;span class="n"&gt;php5&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;dev&lt;/span&gt; &lt;span class="n"&gt;php5&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;cli&lt;/span&gt; &lt;span class="n"&gt;php&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;pear&lt;/span&gt;   &lt;span class="c1"&gt;//安装支持环境&lt;/span&gt;
&lt;span class="n"&gt;apt&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;get&lt;/span&gt; &lt;span class="n"&gt;install&lt;/span&gt; &lt;span class="n"&gt;imagemagick&lt;/span&gt;   &lt;span class="c1"&gt;//有可能不是最新版本，需要通过源代码安装最新版本&lt;/span&gt;

&lt;span class="c1"&gt;//源代码方式安装http://www.imagemagick.org/script/download.php&lt;/span&gt;
&lt;span class="n"&gt;cd&lt;/span&gt; &lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;usr&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;local&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;src&lt;/span&gt; 
&lt;span class="n"&gt;wget&lt;/span&gt; &lt;span class="n"&gt;ftp&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="c1"&gt;//ftp.kddlabs.co.jp/graphics/ImageMagick/ImageMagick-6.8.7-0.tar.gz&lt;/span&gt;
&lt;span class="n"&gt;tar&lt;/span&gt; &lt;span class="n"&gt;xzvf&lt;/span&gt; &lt;span class="n"&gt;ImageMagick&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mf"&gt;6.8.7&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mf"&gt;0.&lt;/span&gt;&lt;span class="n"&gt;tar&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;gz&lt;/span&gt;
&lt;span class="n"&gt;cd&lt;/span&gt; &lt;span class="n"&gt;ImageMagick&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mf"&gt;6.8.7&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;
&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;configure&lt;/span&gt; &lt;span class="o"&gt;&amp;amp;&amp;amp;&lt;/span&gt; &lt;span class="n"&gt;make&lt;/span&gt; &lt;span class="o"&gt;&amp;amp;&amp;amp;&lt;/span&gt; &lt;span class="n"&gt;make&lt;/span&gt; &lt;span class="n"&gt;install&lt;/span&gt;

&lt;span class="n"&gt;apt&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;get&lt;/span&gt; &lt;span class="n"&gt;install&lt;/span&gt; &lt;span class="n"&gt;graphicsmagick&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;libmagick&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;dev&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;compat&lt;/span&gt;
&lt;span class="n"&gt;pecl&lt;/span&gt; &lt;span class="n"&gt;install&lt;/span&gt; &lt;span class="n"&gt;imagick&lt;/span&gt;

&lt;span class="n"&gt;echo&lt;/span&gt; &lt;span class="n"&gt;extension&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;imagick&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;so&lt;/span&gt; &lt;span class="o"&gt;&amp;gt;&amp;gt;/&lt;/span&gt;&lt;span class="n"&gt;etc&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;php5&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;conf&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;d&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;imagick&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;ini&lt;/span&gt;

&lt;span class="n"&gt;service&lt;/span&gt; &lt;span class="n"&gt;apache2&lt;/span&gt; &lt;span class="n"&gt;restart&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;&lt;strong&gt;常见错误：&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;在运行pecl install imagick 时有以下出错提示：&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span class="n"&gt;checking&lt;/span&gt; &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="n"&gt;ImageMagick&lt;/span&gt; &lt;span class="n"&gt;version&lt;/span&gt; &lt;span class="n"&gt;is&lt;/span&gt; &lt;span class="n"&gt;at&lt;/span&gt; &lt;span class="n"&gt;least&lt;/span&gt; &lt;span class="mf"&gt;6.2.4&lt;/span&gt;&lt;span class="p"&gt;...&lt;/span&gt; &lt;span class="n"&gt;configure&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="n"&gt;error&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="n"&gt;no&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt; &lt;span class="n"&gt;You&lt;/span&gt; &lt;span class="n"&gt;need&lt;/span&gt; &lt;span class="n"&gt;at&lt;/span&gt; &lt;span class="n"&gt;least&lt;/span&gt; &lt;span class="n"&gt;Imagemagick&lt;/span&gt; &lt;span class="n"&gt;version&lt;/span&gt; &lt;span class="mf"&gt;6.2.4&lt;/span&gt; &lt;span class="n"&gt;to&lt;/span&gt; &lt;span class="n"&gt;use&lt;/span&gt; &lt;span class="n"&gt;Imagick&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;
&lt;span class="nl"&gt;ERROR:&lt;/span&gt; &lt;span class="err"&gt;`&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;tmp&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;pear&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;temp&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;imagick&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;configure&lt;/span&gt; &lt;span class="o"&gt;--&lt;/span&gt;&lt;span class="n"&gt;with&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;imagick&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;hjw&lt;/span&gt;&lt;span class="err"&gt;&amp;#39;&lt;/span&gt; &lt;span class="n"&gt;failed&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;根据提示是没有安装Imagemagick或者Imagemagick版本不够，可以通过源代码的方式安装最新版本的Imagemagick。&lt;/p&gt;
&lt;h4&gt;4、Linux平台下的字体渲染&lt;/h4&gt;
&lt;p&gt;可以将Windows平台下的雅黑、宋体、开题、黑体等常用中文字体安装到Ubuntu系统中，避免出现截图中的字体不好看的情况，同时也满足对富文本编辑中支持的字体进行渲染。&lt;/p&gt;</summary><category term="Apache"></category><category term="CutyCapt"></category><category term="Linux"></category><category term="Nginx"></category><category term="PHP"></category><category term="TCPDF"></category></entry><entry><title>Tiny Tiny RSS–Google Reader的替代</title><link href="http://loosky.com/technology/2013/07/30/Tiny-Tiny-RSS.html" rel="alternate"></link><updated>2013-07-30T00:00:00+08:00</updated><author><name>Loosky</name></author><id>tag:loosky.com,2013-07-30:technology/2013/07/30/Tiny-Tiny-RSS.html</id><summary type="html">&lt;p&gt;Google Reader是一款&lt;a href="http://xbeta.info/google-reader.htm"&gt;无可替代的伟大产品&lt;/a&gt;，但实实在在地跟我们&lt;a href="http://loosky.net/archives/2789.html"&gt;告别了&lt;/a&gt;。一直以来习惯于通过订阅RSS来浏览文章，说实在话并不喜欢通过微博或者微信来浏览，信息量太大，而真正有用的东西又不多，极容易被淹没，不容易沉淀。&lt;/p&gt;
&lt;p&gt;Google Reader关闭后，一直用着&lt;a href="https://theoldreader.com/"&gt;the Old Reader&lt;/a&gt;，其使用习惯和界面均比较接近于Google Reader。但比较痛苦的地方在于速度和稳定性均不是很好，经常长时间不能访问，难以忍受。于是便想自己搭建一个平台，先尝试了&lt;a href="https://github.com/samuelclay/NewsBlur"&gt;NewsBlur&lt;/a&gt;，基于Django的，步骤相当繁琐。刚好碰到小众软件介绍了&lt;a href="http://www.appinn.com/tiny-tiny-rss/"&gt;Tiny Tiny RSS&lt;/a&gt;，基于PHP+MySQL/PostgreSQL，安装起来也很方便。于是便安装了一个试试，发现挺不错的。&lt;/p&gt;
&lt;p&gt;Tiny Tiny RSS 是使用 &lt;a href="http://www.simplepie.org/"&gt;SimplePie&lt;/a&gt; 作为 RSS 抓取引擎的，抓取回来的文章数据需要保存在 MySQL/PostgreSQL 数据库里，抓取数据的时候，需要消耗一定的流量，所以，如果你的订阅源多的话，搭建类似的站点的确是一个消耗存储空间、带宽的活。&lt;/p&gt;
&lt;h3&gt;一、优点&lt;/h3&gt;
&lt;p&gt;项目主页： &lt;a href="http://tt-rss.org/redmine/"&gt;http://tt-rss.org/&lt;/a&gt;，其优点如下：&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;feed状况检查：可以检查订阅的feeds是否失效&lt;/li&gt;
&lt;li&gt;支持各种主题，包括模仿Google Reeder、feedly界面的主题&lt;/li&gt;
&lt;li&gt;有适合移动设备的皮肤/插件&lt;/li&gt;
&lt;li&gt;支持插件，其中精品插件包括ff_feedcleaner（feed内容过滤）、af_feedmod（制作全文阅读feed）、oneclickpocket（一键发送到pocket）、fever（模拟fever api，支持更多客户端）等&lt;/li&gt;
&lt;li&gt;支持多种平台的客户端，包括Andriod、WP、iOS等&lt;/li&gt;
&lt;li&gt;可以灵活地设置更新频率，第一时间获得订阅更新&lt;/li&gt;
&lt;li&gt;支持导入OPML&lt;/li&gt;
&lt;li&gt;可以收藏&lt;/li&gt;
&lt;li&gt;有中文版本，但不完全&lt;/li&gt;
&lt;li&gt;filter功能：类似gmail的filter。从标题，内容，时间等等中匹配关键词，然后可以选择是打分还是加tag，加label，加星，标记已读，删除条目等，filter可以是作用于所有feed或者指定feed。可以是匹配关键词，或者是剔除关键词。&lt;/li&gt;
&lt;li&gt;条目中的图片可以选择是显示还是隐藏。&lt;/li&gt;
&lt;li&gt;邮件digest。把每天的未读条目作为digest发送到指定邮箱。而且可以选择发送了的条目自动标记为已读。发送时间也可以指定。&lt;/li&gt;
&lt;li&gt;基于sphinx的全文搜索&lt;/li&gt;
&lt;li&gt;...&lt;/li&gt;
&lt;/ol&gt;
&lt;h3&gt;二、安装要求&lt;/h3&gt;
&lt;p&gt;要求其实挺简单的，见&lt;a href="http://tt-rss.org/redmine/projects/tt-rss/wiki#Requirements"&gt;官方wiki&lt;/a&gt;。&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span class="mf"&gt;1.&lt;/span&gt; &lt;span class="n"&gt;PHP&lt;/span&gt;&lt;span class="err"&gt;版本必须高于&lt;/span&gt;&lt;span class="mf"&gt;5.3&lt;/span&gt;&lt;span class="err"&gt;；&lt;/span&gt;
&lt;span class="mf"&gt;2.&lt;/span&gt; &lt;span class="err"&gt;可选&lt;/span&gt;&lt;span class="n"&gt;PostgreSQL&lt;/span&gt; &lt;span class="err"&gt;或&lt;/span&gt; &lt;span class="n"&gt;MySQL&lt;/span&gt;&lt;span class="err"&gt;数据库，其中&lt;/span&gt;&lt;span class="n"&gt;MySQL&lt;/span&gt;&lt;span class="err"&gt;数据库必须支持&lt;/span&gt;&lt;span class="n"&gt;InnoDB&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;h3&gt;三、安装步骤&lt;/h3&gt;
&lt;p&gt;具体安装步骤可参考&lt;a href="http://tt-rss.org/redmine/projects/tt-rss/wiki/InstallationNotes"&gt;Installation Notes&lt;/a&gt;&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;
&lt;p&gt;在按照要求配置好服务器环境后，&lt;a href="https://github.com/gothfox/Tiny-Tiny-RSS/archive/1.9.tar.gz"&gt;下载安装包&lt;/a&gt; （目前最新版本为1.9，Jul 21, 2013）并解压。&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span class="c"&gt;# tar zxfv Tiny-Tiny-RSS-1.x.x.tar.gz&lt;/span&gt;
&lt;span class="c"&gt;# mv Tiny-Tiny-RSS-1.x.x tt-rss&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;输入&lt;a href="http://your.site.com/tt-rss/install/"&gt;http://your.site.com/tt-rss/install/&lt;/a&gt;，并执行安装步骤，填写相应的数据库等信息。
&lt;img alt="安装步骤" src="http://loosky.net/Upload/2013/07/tiny-tiny-rss-install.png" /&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;安装完成后，输入网址 &lt;a href="http://your.site.com/tt-rss/"&gt;http://your.site.com/tt-rss/&lt;/a&gt; 访问系统，系统后台已经部分汉化。默认管理员用户为：&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span class="n"&gt;username&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="n"&gt;admin&lt;/span&gt;&lt;span class="o"&gt;,&lt;/span&gt; &lt;span class="n"&gt;password&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="n"&gt;password&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;&lt;img alt="系统登录" src="http://loosky.net/Upload/2013/07/tiny-tiny-rss-login.png" /&gt;&lt;/p&gt;
&lt;p&gt;登陆后即可手动添加RSS地址或者直接导入OPML文件了。&lt;/p&gt;
&lt;p&gt;&lt;img alt="导入OPML文件" src="http://loosky.net/Upload/2013/07/tiny-tiny-rss-importrss.png" /&gt;&lt;/p&gt;
&lt;h3&gt;四、优化配置&lt;/h3&gt;
&lt;h4&gt;1. 配置订阅条目自动更新&lt;/h4&gt;
&lt;p&gt;详细操作说明见&lt;a href="http://tt-rss.org/redmine/projects/tt-rss/wiki/UpdatingFeeds"&gt;官方wiki&lt;/a&gt;，可以采用三种方式，本站使用的是第二种，即通过crontab来定时更新feeds。&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;这里需要注意的是更新脚本文件&lt;code&gt;update.php&lt;/code&gt;或&lt;code&gt;update_daemon2.php&lt;/code&gt;不能由root用户来执行，可以通过apache或者Nginx的运行用户来执行，如apache或者www等。&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;当我们以&lt;code&gt;root&lt;/code&gt;用户直接执行命令时，会出现如下错误：&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;root&lt;/span&gt;&lt;span class="err"&gt;@&lt;/span&gt;&lt;span class="n"&gt;localhost&lt;/span&gt; &lt;span class="o"&gt;~&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="err"&gt;#&lt;/span&gt; &lt;span class="n"&gt;php&lt;/span&gt; &lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;home&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;wwwroot&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="err"&gt;具体路径&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;update&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;php&lt;/span&gt; 
&lt;span class="n"&gt;Tiny&lt;/span&gt; &lt;span class="n"&gt;Tiny&lt;/span&gt; &lt;span class="n"&gt;RSS&lt;/span&gt; &lt;span class="n"&gt;was&lt;/span&gt; &lt;span class="n"&gt;unable&lt;/span&gt; &lt;span class="n"&gt;to&lt;/span&gt; &lt;span class="n"&gt;start&lt;/span&gt; &lt;span class="n"&gt;properly&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt; &lt;span class="n"&gt;This&lt;/span&gt; &lt;span class="n"&gt;usually&lt;/span&gt; &lt;span class="n"&gt;means&lt;/span&gt; &lt;span class="n"&gt;a&lt;/span&gt; &lt;span class="n"&gt;misconfiguration&lt;/span&gt; &lt;span class="n"&gt;or&lt;/span&gt; &lt;span class="n"&gt;an&lt;/span&gt; &lt;span class="n"&gt;incomplete&lt;/span&gt; &lt;span class="n"&gt;upgrade&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;
&lt;span class="n"&gt;Please&lt;/span&gt; &lt;span class="n"&gt;fix&lt;/span&gt; &lt;span class="n"&gt;errors&lt;/span&gt; &lt;span class="n"&gt;indicated&lt;/span&gt; &lt;span class="n"&gt;by&lt;/span&gt; &lt;span class="n"&gt;the&lt;/span&gt; &lt;span class="n"&gt;following&lt;/span&gt; &lt;span class="n"&gt;messages&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;

 &lt;span class="o"&gt;*&lt;/span&gt; &lt;span class="n"&gt;Please&lt;/span&gt; &lt;span class="n"&gt;don&lt;/span&gt;&lt;span class="err"&gt;&amp;#39;&lt;/span&gt;&lt;span class="n"&gt;t&lt;/span&gt; &lt;span class="n"&gt;run&lt;/span&gt; &lt;span class="n"&gt;this&lt;/span&gt; &lt;span class="n"&gt;script&lt;/span&gt; &lt;span class="n"&gt;as&lt;/span&gt; &lt;span class="n"&gt;root&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;

&lt;span class="n"&gt;You&lt;/span&gt; &lt;span class="n"&gt;might&lt;/span&gt; &lt;span class="n"&gt;want&lt;/span&gt; &lt;span class="n"&gt;to&lt;/span&gt; &lt;span class="n"&gt;check&lt;/span&gt; &lt;span class="n"&gt;tt&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;rss&lt;/span&gt; &lt;span class="n"&gt;wiki&lt;/span&gt; &lt;span class="n"&gt;or&lt;/span&gt; &lt;span class="n"&gt;the&lt;/span&gt; &lt;span class="n"&gt;forums&lt;/span&gt; &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;more&lt;/span&gt; &lt;span class="n"&gt;information&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;
&lt;span class="n"&gt;Please&lt;/span&gt; &lt;span class="n"&gt;search&lt;/span&gt; &lt;span class="n"&gt;the&lt;/span&gt; &lt;span class="n"&gt;forums&lt;/span&gt; &lt;span class="n"&gt;before&lt;/span&gt; &lt;span class="n"&gt;creating&lt;/span&gt; &lt;span class="n"&gt;new&lt;/span&gt; &lt;span class="n"&gt;topic&lt;/span&gt; &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;your&lt;/span&gt; &lt;span class="n"&gt;question&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;即提示不能以root用户运行脚本，否则订阅条目不能自动更新。因此，可以通过给普通用户如&lt;code&gt;www&lt;/code&gt;添加crontab运行脚本：&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span class="c"&gt;#crontab -u www -e&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;添加如下内容：&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span class="err"&gt;*/&lt;/span&gt;&lt;span class="mi"&gt;30&lt;/span&gt; &lt;span class="o"&gt;*&lt;/span&gt; &lt;span class="o"&gt;*&lt;/span&gt; &lt;span class="o"&gt;*&lt;/span&gt; &lt;span class="o"&gt;*&lt;/span&gt; &lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;usr&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;bin&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;php&lt;/span&gt; &lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;home&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;wwwroot&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="err"&gt;具体路径&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;update&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;php&lt;/span&gt; &lt;span class="o"&gt;--&lt;/span&gt;&lt;span class="n"&gt;feeds&lt;/span&gt; &lt;span class="o"&gt;--&lt;/span&gt;&lt;span class="n"&gt;quiet&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;同时在后台可以设置feeds的更新时间。&lt;/p&gt;
&lt;p&gt;&lt;img alt="设置更新时间" src="http://loosky.net/Upload/2013/07/tiny-tiny-rss-update.png" /&gt;&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;说明：&lt;/strong&gt;&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;必须用普通用户来运行更新脚本；&lt;/li&gt;
&lt;li&gt;更新时间这里设置为每30分钟更新一次，具体可调；&lt;/li&gt;
&lt;li&gt;若你的系统中php的路径不是&lt;code&gt;/usr/bin/php&lt;/code&gt;,需要修改之，同时也注意修改&lt;code&gt;config.php&lt;/code&gt;中的内容；&lt;/li&gt;
&lt;li&gt;修改&lt;code&gt;/home/wwwroot/具体路径/update.php&lt;/code&gt;为你的具体路径。&lt;/li&gt;
&lt;/ol&gt;
&lt;h4&gt;2. 安装皮肤&lt;/h4&gt;
&lt;p&gt;Tiny Tiny RSS&lt;a href="http://tt-rss.org/forum/viewtopic.php?f=22&amp;amp;t=1679"&gt;安装皮肤&lt;/a&gt;挺简单的，将CSS文件放入themes目录下，并在管理员后台进行选择就可以了，当然也可以通过自定义CSS的方式。&lt;/p&gt;
&lt;p&gt;&lt;img alt="定义皮肤" src="http://loosky.net/Upload/2013/07/tiny-tiny-rss-theme.png" /&gt;&lt;/p&gt;
&lt;p&gt;推荐一款仿Google Reader的皮肤： &lt;a href="https://github.com/naeramarth7/clean-greader"&gt;clean-greader&lt;/a&gt;，更多的可在&lt;a href="http://tt-rss.org/forum/viewforum.php?f=22"&gt;官方论坛&lt;/a&gt;中寻找。&lt;/p&gt;
&lt;p&gt;&lt;img alt="clean-greader" src="http://loosky.net/Upload/2013/07/tiny-tiny-rss.png" /&gt;&lt;/p&gt;
&lt;h4&gt;3. 安装插件&lt;/h4&gt;
&lt;p&gt;系统后台自带了很多系统插件以及第三方插件，我们只需要启用就好，当然也可以去论坛&lt;a href="http://tt-rss.org/forum/viewforum.php?f=22"&gt;寻找插件&lt;/a&gt;。&lt;/p&gt;
&lt;p&gt;&lt;img alt="" src="http://loosky.net/Upload/2013/07/tiny-tiny-rss-plugins.png" /&gt;&lt;/p&gt;
&lt;p&gt;付上大多数插件的说明，所有插件一般有三种，在文章右下角生成响应图标的、在设置标签生成设置页面的、其他无图标无设置的插件[&lt;a href="https://wjchen.me/index.php/ttrss-1.html"&gt;参考&lt;/a&gt;]&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;af_unburn:解决feedburner等rss链接跳转。&lt;/li&gt;
&lt;li&gt;bookmarklets:在设置-信息源生成bookmarklets标签。&lt;/li&gt;
&lt;li&gt;embed_original:图标插件，点击图标会显示文章原始内容，而不是rss。&lt;/li&gt;
&lt;li&gt;fever:模拟fever api，在设置-Fver Emulation，设置好密码，可以和tt-rss的登录密码不同，然后就能支持fever的客户端比如reeder、Mr. Reader。&lt;/li&gt;
&lt;li&gt;ff_feedcleaner:feed广告过滤，在设置标签生成FeecCleaner标签，过滤规则要用正则表达式，比较复杂。&lt;/li&gt;
&lt;li&gt;googlereaderkeys:模拟google reader快捷键，如J、K等。&lt;/li&gt;
&lt;li&gt;import_export:在设置-信息源，导入导出配置。&lt;/li&gt;
&lt;li&gt;mail:图标插件，点击通过邮件分享。&lt;/li&gt;
&lt;li&gt;mark_button:文章右下角能够快速将文章标记为已读未读。&lt;/li&gt;
&lt;li&gt;mobilize:图标插件，点击显示readability简化的页面。&lt;/li&gt;
&lt;li&gt;note:图标插件。&lt;/li&gt;
&lt;li&gt;nsfw:根据标签隐藏文章内容。&lt;/li&gt;
&lt;li&gt;share:图标插件，点击生成唯一的url方便分享。&lt;/li&gt;
&lt;li&gt;swap_jk:添加j、k快捷键，类似vim。&lt;/li&gt;
&lt;/ul&gt;
&lt;h4&gt;4. 移动端支持&lt;/h4&gt;
&lt;p&gt;要支持移动端，既可以通过手机、平板电脑等设备进行访问，必须先开启系统支持，即在管理后台偏好设置里面勾选“Enable API”。&lt;/p&gt;
&lt;p&gt;&lt;img alt="Enable API" src="http://loosky.net/Upload/2013/07/tiny-tiny-rss-enableapi.png" /&gt;&lt;/p&gt;
&lt;p&gt;&lt;a href="http://tt-rss.org/redmine/projects/tt-rss-android/wiki"&gt;官方开发&lt;/a&gt;的Andriod客户端：&lt;a href="https://play.google.com/store/apps/details?id=org.fox.ttrss&amp;amp;feature=search_result"&gt;Tiny Tiny RSS&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;同时也推荐一下Nils Braden 开发的 &lt;a href="https://play.google.com/store/apps/details?id=org.ttrssreader&amp;amp;feature=related_apps#?t=W251bGwsMSwxLDEwOSwib3JnLnR0cnNzcmVhZGVyIl0."&gt;TTRSS-Reader&lt;/a&gt; 这个 Android 手机客户端，这个客户端提供针对Tiny Tiny RSS的手机离线阅读功能，还可以离线缓存图片。&lt;/p&gt;
&lt;p&gt;&lt;img alt="移动客户端" src="http://loosky.net/Upload/2013/07/tiny-tiny-rss-client.png" /&gt;&lt;/p&gt;</summary><category term="Google"></category><category term="Google Reader"></category><category term="PHP"></category><category term="RSS"></category><category term="Tiny Tiny RSS"></category></entry></feed>